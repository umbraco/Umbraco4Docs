---
meta.Title: "Installing and Configuring Umbraco Deploy"
meta.Description: "Steps to how to install and configure Umbraco Deploy"
---

# Installing Umbraco Deploy

In this article, we will cover the steps in order for you to install and configure Umbraco Deploy on a new or existing website.

## Prerequisites

Ensure you have read and followed the setup guide for [new](new-site.md) or [Existing](existing-site.md) projects.

## Source Control Configuration

After the Umbraco files have been committed add the following lines to the .gitignore so that they will not be picked up by Git when we are deploying.

```none
**/media/*

# Umbraco deploy specific
**/umbraco/Deploy/deploy*
```

{% hint style="info" %}
The deploy specific update here will ensure that temporary files generated by Deploy during it's operations will not be included in source control.
{% endhint %}

Make sure that the updates to the .gitignore file are also committed.

## Installing and Configuring Umbraco Deploy

When Umbraco has been installed in a repository, we can go ahead and install Umbraco Deploy in the project.

To install Umbraco Deploy, run `dotnet add package Umbraco.Deploy.OnPrem` from the command line or `Install-Package Umbraco.Deploy.OnPrem` from the package manager console in Visual Studio.

{% hint style="info" %}
To be able to use Umbraco Forms with Umbraco Deploy, you need to install the  `Umbraco.Deploy.Forms` package as well.
{% endhint %}

{% hint style="info" %}
In order to deploy content based on certain rich core and community property editors - including Nested Content, Multi URL Picker and Block List Editor - there is one further NuGet package to install: `Umbraco.Deploy.Contrib`.
{% endhint %}

When Umbraco Deploy has been installed, to be able to use it in the project you will need to create and add configuration for an API key.

The API key should be a random string of at least 10 characters.

The following code snippet can be used to generate a random key, using a tool like LinqPad.

```C#
public string GetRandomKey(int bytelength)
{
   byte[] buff = new byte[bytelength];
   RNGCryptoServiceProvider rng = new RNGCryptoServiceProvider();
   rng.GetBytes(buff);
   StringBuilder sb = new StringBuilder(bytelength * 2);
   for (int i = 0; i < buff.Length; i++)
       sb.Append(string.Format("{0:X2}", buff[i]));
   return sb.ToString();
}
```

This same Deploy API key must be used on each environment for the same website.

{% hint style="info" %}
We strongly recommend to generate different keys for different websites.
{% endhint %}

The key should be applied in `appSettings.json`.

```json
{
  "Umbraco": {
    "Deploy": {
        "Settings": {
            "ApiKey": "<your API key here>",
        }
    }
  }
}
```

#### Configuring Environments

Once the `appSetting` and API key have been added, it is now time to configure the environments, also in the `appSettings.json` file.

An example configuration with a single upstream environment file will look like this:

```json
{
   "Umbraco":{
      "Deploy":{
         "Settings":{
            "ApiKey": "<your API key here>"
         },
         "Project":{
            "CurrentWorkspaceName": "Live",
            "Workspaces":[
               {
                  "Id": "efef5e89-a19b-434b-b68a-26e022a0ad52",
                  "Name": "Live",
                  "Type": "live",
                  "Url" :"https://localhost:44307"
               }
            ]
         }
      }
   }
}
```

The setting under _Project:CurrentWorkspaceName_ should match the _Name_ provided in the list of _Workspaces_ that matches the current environment.  Using this Umbraco Deploy will indicate the correct current environment on the "Workspaces" dashboard.

{% hint style="info" %}
In Umbraco Deploy 9, this value was set using the configuration key _Debug:EnvironmentName_. Although included under a "Debug" section, this setting is required for the installations of Umbraco Deploy on-premises (i.e. other than on Umbraco Cloud). Hence why it was moved to the "Project" section in Umbraco Deploy 10.
{% endhint %}

Expected values for _Type_ are "development", "staging" or "live". These settings are required, though strictly only for the latter is it necessary to use the specific value of "live", so other values can be used if you have more than these three environments.

You will need to generate a unique GUID for each environment. This can be done in Visual Studio:

1. Open "Tools".
2. Select "Create GUID".
3. Use the Registry Format.
4. Copy the GUID into the `id` value.
5. Generate a "New GUID" for each environment you will be adding to your setup.

The URL configured for each environment should be the root URL for the website, and needs to be accessible by the other environments over **HTTPS**.

#### Validating Source Control

Once the configuration has been set up with the correct information we can now go ahead and make sure that the source control is including our files in the `/umbraco/Deploy` folder of our Umbraco project.

This can be done by going to the `/umbraco/Deploy/Revision` folder of the project and create a test `.uda` file, and then check in either your Git GUI or in the command line and verify whether the test file is being tracked.

![Test UDA file](images/test-UDA.png)

We can see that the file has been created and it is being tracked by Git and we can go ahead and delete the test file.

Now that Umbraco Deploy has been installed on the project, we can go ahead and commit the files to the repository.

**Do not push the files up yet** as a CI/CD build server will first need to be set up and connected to our a repository.

#### Include your Umbraco Deploy license file

Before moving on to setting up the build server, make sure that your license is included in your project.

The file needs to be placed in the `/umbraco/Licenses` folder.
